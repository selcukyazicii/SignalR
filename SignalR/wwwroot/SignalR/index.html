<!DOCTYPE html>
<html lang="en">
<head>
    <script src="signalr.min.js"></script>
    <script src="jquery.min.js"></script>

<script>
    $(document).ready(()=>{
    const connection=new signalR.HubConnectionBuilder()
    .withUrl("https://localhost:5001/MyHub")
    .withAutomaticReconnect([1000,1000,1100,2000]) //bağlantı var lakin koptuğu durumlarda kullanılır
    .build();

    async function start(){
        try{
            await connection.start();
        }catch(error){
            setTimeout(()=>start(),2000);
        }
    }
    start();

    
    $("#btnGonder").click(()=>{
        let message=$("#txtMessage").val();
        connection.invoke("SendMessageAsync",message).catch(error=>console.log(`Hata oluştu. ${error}`));
    });

    connection.on("receiveMessage",message=>{
         $("div").append(message+"<br>");
    });

    //bağlantının hiç kurulmadığı durumlarda kullanılan fonksiyon
    
    
    });
</script>
 
</head>
<body>
    <input type="text" id="txtMessage">
    <button id="btnGonder">Gönder</button>

<div></div>

</body>
</html>